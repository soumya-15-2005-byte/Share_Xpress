<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ShareXpress - File Sharing Made Easy</title>
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div class="container">
    <img src="/img/logo.png" alt="ShareXpress logo" class="logo">
    
    <section class="upload-section">
      <div class="upload-card">
        <div class="upload-icon">
          <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.89 22 5.99 22H18C19.1 22 20 21.1 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M12 18V12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M9 15L12 12L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        
        <h1>ShareXpress</h1>
        <p class="subtitle">Upload and share your files instantly</p>
        
        <form id="uploadForm" action="/api/files" method="POST" enctype="multipart/form-data">
          <div class="file-input-wrapper">
            <input type="file" id="fileInput" name="myfile" required />
            <label for="fileInput" class="file-label">
              <span class="file-icon">üìÅ</span>
              <span class="file-text">Choose a file</span>
              <span class="file-name" id="fileName"></span>
            </label>
          </div>
          
          <div class="upload-progress" id="uploadProgress" style="display: none;">
            <div class="progress-bar">
              <div class="progress-fill" id="progressFill"></div>
            </div>
            <p class="progress-text">Uploading...</p>
          </div>
          
          <button type="submit" class="upload-btn" id="uploadBtn">
            <span>Upload File</span>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M7 10L12 15L17 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M12 15V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </form>
        
        <div class="result-message" id="resultMessage"></div>
      </div>
    </section>
  </div>
  
  <script>
    const fileInput = document.getElementById('fileInput');
    const fileName = document.getElementById('fileName');
    const uploadForm = document.getElementById('uploadForm');
    const uploadBtn = document.getElementById('uploadBtn');
    const uploadProgress = document.getElementById('uploadProgress');
    const progressFill = document.getElementById('progressFill');
    const resultMessage = document.getElementById('resultMessage');
    
    fileInput.addEventListener('change', (e) => {
      if (e.target.files.length > 0) {
        fileName.textContent = e.target.files[0].name;
        fileName.style.display = 'block';
      }
    });
    
    uploadForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const formData = new FormData(uploadForm);
      uploadBtn.disabled = true;
      uploadBtn.innerHTML = '<span>Uploading...</span>';
      uploadProgress.style.display = 'block';
      resultMessage.innerHTML = '';
      
      try {
        const response = await fetch('/api/files', {
          method: 'POST',
          body: formData
        });
        
        const data = await response.json();
        
        if (response.ok && data.file) {
          resultMessage.innerHTML = `
            <div class="success-message">
              <div class="link-container">
                <input type="text" id="shareLink" value="${data.file}" readonly class="share-link-input">
                <button onclick="copyLink()" class="copy-btn" id="copyBtn">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M16 1H4C2.9 1 2 1.9 2 3V17H4V3H16V1ZM19 5H8C6.9 5 6 5.9 6 7V21C6 22.1 6.9 23 8 23H19C20.1 23 21 22.1 21 21V7C21 5.9 20.1 5 19 5ZM19 21H8V7H19V21Z" fill="currentColor"/>
                  </svg>
                  <span id="copyText">Copy</span>
                </button>
              </div>
              <a href="${data.file}" class="view-btn" target="_blank">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M12 4.5C7 4.5 2.73 7.61 1 12C2.73 16.39 7 19.5 12 19.5C17 19.5 21.27 16.39 23 12C21.27 7.61 17 4.5 12 4.5ZM12 17C9.24 17 7 14.76 7 12C7 9.24 9.24 7 12 7C14.76 7 17 9.24 17 12C17 14.76 14.76 17 12 17ZM12 9C10.34 9 9 10.34 9 12C9 13.66 10.34 15 12 15C13.66 15 15 13.66 15 12C15 10.34 13.66 9 12 9Z" fill="currentColor"/>
                </svg>
                View
              </a>
            </div>
          `;
          uploadForm.reset();
          fileName.textContent = '';
          fileName.style.display = 'none';
        } else {
          throw new Error(data.error || 'Upload failed');
        }
      } catch (error) {
        resultMessage.innerHTML = `
          <div class="error-message">
            <h3>‚ùå Upload Failed</h3>
            <p>${error.message}</p>
          </div>
        `;
      } finally {
        uploadBtn.disabled = false;
        uploadBtn.innerHTML = '<span>Upload File</span><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M7 10L12 15L17 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 15V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
        uploadProgress.style.display = 'none';
      }
    });
    
    function copyLink() {
      const linkInput = document.getElementById('shareLink');
      const copyBtn = document.getElementById('copyBtn');
      const copyText = document.getElementById('copyText');
      
      linkInput.select();
      linkInput.setSelectionRange(0, 99999); // For mobile devices
      
      navigator.clipboard.writeText(linkInput.value).then(() => {
        copyText.textContent = 'Copied!';
        copyBtn.classList.add('copied');
        setTimeout(() => {
          copyText.textContent = 'Copy';
          copyBtn.classList.remove('copied');
        }, 2000);
      }).catch(() => {
        // Fallback for older browsers
        document.execCommand('copy');
        copyText.textContent = 'Copied!';
        copyBtn.classList.add('copied');
        setTimeout(() => {
          copyText.textContent = 'Copy';
          copyBtn.classList.remove('copied');
        }, 2000);
      });
    }
  </script>
</body>
</html>
